<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?define VsVer=2013 ?>
  <Fragment>
    <CustomAction Id="SetCmdExtVS$(var.VsVer)Setup" Property="QtExecCmdLine" Value="&quot;[PATHVS2013]devenv.exe&quot; /setup" />
    <CustomAction Id="RunCmdExtVS$(var.VsVer)Setup" BinaryKey="WixCA" DllEntry="CAQuietExec" Return="ignore" Impersonate="no" Execute="deferred" />
    <CustomAction Id="SetCmdExtVS$(var.VsVer)Templates" Property="QtExecCmdLine" Value="&quot;[PATHVS2013]devenv.exe&quot; /InstallVSTemplates" />
    <CustomAction Id="RunCmdExtVS$(var.VsVer)Templates" BinaryKey="WixCA" DllEntry="CAQuietExec" Return="ignore" Impersonate="no" Execute="deferred" />

    <UI>
      <ProgressText Action="RunCmdExtVS$(var.VsVer)Setup" Template="[1]">Updating Visual Studio $(var.VsVer) Registration</ProgressText>
      <ProgressText Action="RunCmdExtVS$(var.VsVer)Templates" Template="[1]">Updating Visual Studio $(var.VsVer) Registration</ProgressText>
    </UI>

    <InstallExecuteSequence>
      <Custom Action="SetCmdExtVS$(var.VsVer)Setup" After="InstallFinalize"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2013 = "")]]></Custom>
      <Custom Action="RunCmdExtVS$(var.VsVer)Setup" After="SetCmdExtVS$(var.VsVer)Setup"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2013 = "")]]></Custom>
      <Custom Action="SetCmdExtVS$(var.VsVer)Templates" After="RunCmdExtVS$(var.VsVer)Setup"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2013 = "")]]></Custom>
      <Custom Action="RunCmdExtVS$(var.VsVer)Templates" After="SetCmdExtVS$(var.VsVer)Templates"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2013 = "")]]></Custom>
    </InstallExecuteSequence>
  </Fragment>
  <Fragment>
    <DirectoryRef Id="WixWPF36_VS$(var.VsVer)ExtensionsDir">
      <Directory Id="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Name="WPFBootstrapper" />
      <Directory Id="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Name="WPFBootstrapperSolution" />
      <Directory Id="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Name="WPFBootstrapperUI" />
    </DirectoryRef>
    <DirectoryRef Id="WixWPF37_VS$(var.VsVer)ExtensionsDir">
      <Directory Id="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Name="WPFBootstrapper" />
      <Directory Id="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Name="WPFBootstrapperSolution" />
      <Directory Id="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Name="WPFBootstrapperUI" />
    </DirectoryRef>
    <DirectoryRef Id="WixWPF38_VS$(var.VsVer)ExtensionsDir">
      <Directory Id="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Name="WPFBootstrapper" />
      <Directory Id="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Name="WPFBootstrapperSolution" />
      <Directory Id="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Name="WPFBootstrapperUI" />
    </DirectoryRef>
  </Fragment>
  <Fragment>
    <ComponentGroup Id="WixWPF36_VS$(var.VsVer)Extension">
      <Component Id="WixWPF36_VS$(var.VsVer)ManifestComponent" Directory="WixWPF36_VS$(var.VsVer)ExtensionsDir" Guid="{0DB12108-31FF-4937-8113-F55F756CBBAF}">
        <File Id="WixWPF36_VS$(var.VsVer)ManifestFile" KeyPath="yes" Source="$(var.Ext36)\extension.vsixmanifest" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)LogoComponent" Directory="WixWPF36_VS$(var.VsVer)ExtensionsDir" Guid="{9DBBBE0F-7CDC-4D42-B57C-66C6C1B2E377}">
        <File Id="WixWPF36_VS$(var.VsVer)LogoFile" KeyPath="yes" Source="$(var.Ext36)\Logo.png" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperComponent" Directory="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Guid="{A699D934-ADED-49A7-821C-7E984A0C45E8}">
        <File Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperFile" KeyPath="yes" Source="$(var.Ext36)\WPFBootstrapper\WPFBootstrapper.zip" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperSolutionComponent" Directory="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Guid="{BC5010B6-ECDC-4039-B786-DD4B617E3FEA}">
        <File Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperSolutionFile" KeyPath="yes" Source="$(var.Ext36)\WPFBootstrapperSolution\WPFBootstrapperSolution.zip" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperUIComponent" Directory="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Guid="{A1CA72E0-EFB3-41BF-A2F6-D9C40C835B0D}">
        <File Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperUIFile" KeyPath="yes" Source="$(var.Ext36)\WPFBootstrapperUI\WPFBootstrapperUI.zip" />
      </Component>
    </ComponentGroup>
    <ComponentGroup Id="WixWPF37_VS$(var.VsVer)Extension">
      <Component Id="WixWPF37_VS$(var.VsVer)ManifestComponent" Directory="WixWPF37_VS$(var.VsVer)ExtensionsDir" Guid="{DF7442FA-F914-439C-9C80-13B56F7FBAE0}">
        <File Id="WixWPF37_VS$(var.VsVer)ManifestFile" KeyPath="yes" Source="$(var.Ext37)\extension.vsixmanifest" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)LogoComponent" Directory="WixWPF37_VS$(var.VsVer)ExtensionsDir" Guid="{0DB5BB8D-B75D-4D38-9DE3-684299C711A7}">
        <File Id="WixWPF37_VS$(var.VsVer)LogoFile" KeyPath="yes" Source="$(var.Ext37)\Logo.png" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperComponent" Directory="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Guid="{560C7AEF-E47C-421C-9093-C1F9A47512BD}">
        <File Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperFile" KeyPath="yes" Source="$(var.Ext37)\WPFBootstrapper\WPFBootstrapper.zip" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperSolutionComponent" Directory="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Guid="{89D25701-C1FE-412C-B990-7743DF0D9B53}">
        <File Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperSolutionFile" KeyPath="yes" Source="$(var.Ext37)\WPFBootstrapperSolution\WPFBootstrapperSolution.zip" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperUIComponent" Directory="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Guid="{1DC5061D-551F-4FA5-845D-1D0F1A23E6C5}">
        <File Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperUIFile" KeyPath="yes" Source="$(var.Ext37)\WPFBootstrapperUI\WPFBootstrapperUI.zip" />
      </Component>
    </ComponentGroup>
    <ComponentGroup Id="WixWPF38_VS$(var.VsVer)Extension">
      <Component Id="WixWPF38_VS$(var.VsVer)ManifestComponent" Directory="WixWPF38_VS$(var.VsVer)ExtensionsDir" Guid="{CA411B3E-4B71-4CE0-AC90-E00029A7E514}">
        <File Id="WixWPF38_VS$(var.VsVer)ManifestFile" KeyPath="yes" Source="$(var.Ext38)\extension.vsixmanifest" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)LogoComponent" Directory="WixWPF38_VS$(var.VsVer)ExtensionsDir" Guid="{909BA9EC-DBFB-49BB-8E49-27F2983D9A76}">
        <File Id="WixWPF38_VS$(var.VsVer)LogoFile" KeyPath="yes" Source="$(var.Ext38)\Logo.png" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperComponent" Directory="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Guid="{E704446E-8C03-4CD6-B4FD-104CD1692FDE}">
        <File Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperFile" KeyPath="yes" Source="$(var.Ext38)\WPFBootstrapper\WPFBootstrapper.zip" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperSolutionComponent" Directory="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Guid="{D892BF7E-87A6-4574-A8A2-6E8EF5DE815C}">
        <File Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperSolutionFile" KeyPath="yes" Source="$(var.Ext38)\WPFBootstrapperSolution\WPFBootstrapperSolution.zip" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperUIComponent" Directory="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Guid="{BCDF9DA3-1EEA-47F4-9130-2B8B832015D2}">
        <File Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperUIFile" KeyPath="yes" Source="$(var.Ext38)\WPFBootstrapperUI\WPFBootstrapperUI.zip" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>