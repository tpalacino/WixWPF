<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?define VsVer=2012 ?>
  <Fragment>
    <CustomAction Id="SetCmdExtVS$(var.VsVer)Setup" Property="QtExecCmdLine" Value="&quot;[PATHVS2012]devenv.exe&quot; /setup" />
    <CustomAction Id="RunCmdExtVS$(var.VsVer)Setup" BinaryKey="WixCA" DllEntry="CAQuietExec" Return="ignore" Impersonate="no" Execute="deferred" />
    <CustomAction Id="SetCmdExtVS$(var.VsVer)Templates" Property="QtExecCmdLine" Value="&quot;[PATHVS2012]devenv.exe&quot; /InstallVSTemplates" />
    <CustomAction Id="RunCmdExtVS$(var.VsVer)Templates" BinaryKey="WixCA" DllEntry="CAQuietExec" Return="ignore" Impersonate="no" Execute="deferred" />

    <UI>
      <ProgressText Action="RunCmdExtVS$(var.VsVer)Setup" Template="[1]">Updating Visual Studio $(var.VsVer) Registration</ProgressText>
      <ProgressText Action="RunCmdExtVS$(var.VsVer)Templates" Template="[1]">Updating Visual Studio $(var.VsVer) Registration</ProgressText>
    </UI>

    <InstallExecuteSequence>
      <Custom Action="SetCmdExtVS$(var.VsVer)Setup" After="InstallFinalize"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2012 = "")]]></Custom>
      <Custom Action="RunCmdExtVS$(var.VsVer)Setup" After="SetCmdExtVS$(var.VsVer)Setup"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2012 = "")]]></Custom>
      <Custom Action="SetCmdExtVS$(var.VsVer)Templates" After="RunCmdExtVS$(var.VsVer)Setup"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2012 = "")]]></Custom>
      <Custom Action="RunCmdExtVS$(var.VsVer)Templates" After="SetCmdExtVS$(var.VsVer)Templates"><![CDATA[NOT Installed AND (DEPLOYVS = 1 AND NOT PATHVS2012 = "")]]></Custom>
    </InstallExecuteSequence>
  </Fragment>
  <Fragment>
    <DirectoryRef Id="WixWPF36_VS$(var.VsVer)ExtensionsDir">
      <Directory Id="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Name="WPFBootstrapper" />
      <Directory Id="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Name="WPFBootstrapperSolution" />
      <Directory Id="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Name="WPFBootstrapperUI" />
    </DirectoryRef>
    <DirectoryRef Id="WixWPF37_VS$(var.VsVer)ExtensionsDir">
      <Directory Id="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Name="WPFBootstrapper" />
      <Directory Id="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Name="WPFBootstrapperSolution" />
      <Directory Id="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Name="WPFBootstrapperUI" />
    </DirectoryRef>
    <DirectoryRef Id="WixWPF38_VS$(var.VsVer)ExtensionsDir">
      <Directory Id="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Name="WPFBootstrapper" />
      <Directory Id="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Name="WPFBootstrapperSolution" />
      <Directory Id="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Name="WPFBootstrapperUI" />
    </DirectoryRef>
  </Fragment>
  <Fragment>
    <ComponentGroup Id="WixWPF36_VS$(var.VsVer)Extension">
      <Component Id="WixWPF36_VS$(var.VsVer)ManifestComponent" Directory="WixWPF36_VS$(var.VsVer)ExtensionsDir" Guid="{D0B884C1-C86C-4E3F-979D-E4A73F163775}">
        <File Id="WixWPF36_VS$(var.VsVer)ManifestFile" KeyPath="yes" Source="$(var.Ext36)\extension.vsixmanifest" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)LogoComponent" Directory="WixWPF36_VS$(var.VsVer)ExtensionsDir" Guid="{DA54EE14-9527-4BED-B1F3-1715FE79BBE9}">
        <File Id="WixWPF36_VS$(var.VsVer)LogoFile" KeyPath="yes" Source="$(var.Ext36)\Logo.png" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperComponent" Directory="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Guid="{76301EBF-D8F6-4354-9A79-03F82885E363}">
        <File Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperFile" KeyPath="yes" Source="$(var.Ext36)\WPFBootstrapper\WPFBootstrapper.zip" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperSolutionComponent" Directory="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Guid="{AC02AF90-9FE4-41BD-93EF-8F423AB62BF5}">
        <File Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperSolutionFile" KeyPath="yes" Source="$(var.Ext36)\WPFBootstrapperSolution\WPFBootstrapperSolution.zip" />
      </Component>
      <Component Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperUIComponent" Directory="WixWPF36_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Guid="{565F76FD-6C3A-4746-A247-783E90CAB2DD}">
        <File Id="WixWPF36_VS$(var.VsVer)WPFBootstrapperUIFile" KeyPath="yes" Source="$(var.Ext36)\WPFBootstrapperUI\WPFBootstrapperUI.zip" />
      </Component>
    </ComponentGroup>
    <ComponentGroup Id="WixWPF37_VS$(var.VsVer)Extension">
      <Component Id="WixWPF37_VS$(var.VsVer)ManifestComponent" Directory="WixWPF37_VS$(var.VsVer)ExtensionsDir" Guid="{776C5C2A-AA0E-4230-BD47-5B9E76487924}">
        <File Id="WixWPF37_VS$(var.VsVer)ManifestFile" KeyPath="yes" Source="$(var.Ext37)\extension.vsixmanifest" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)LogoComponent" Directory="WixWPF37_VS$(var.VsVer)ExtensionsDir" Guid="{A177FB3B-5EBB-4667-86FE-AEC5D709A5F6}">
        <File Id="WixWPF37_VS$(var.VsVer)LogoFile" KeyPath="yes" Source="$(var.Ext37)\Logo.png" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperComponent" Directory="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Guid="{6B754172-B94E-4F77-BFA5-BA6434F54EB5}">
        <File Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperFile" KeyPath="yes" Source="$(var.Ext37)\WPFBootstrapper\WPFBootstrapper.zip" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperSolutionComponent" Directory="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Guid="{CCD4FB50-F3FC-409D-9652-A46416D2824B}">
        <File Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperSolutionFile" KeyPath="yes" Source="$(var.Ext37)\WPFBootstrapperSolution\WPFBootstrapperSolution.zip" />
      </Component>
      <Component Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperUIComponent" Directory="WixWPF37_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Guid="{6CA6C65F-7ED3-46E8-AAC7-14BCEDCCD32D}">
        <File Id="WixWPF37_VS$(var.VsVer)WPFBootstrapperUIFile" KeyPath="yes" Source="$(var.Ext37)\WPFBootstrapperUI\WPFBootstrapperUI.zip" />
      </Component>
    </ComponentGroup>
    <ComponentGroup Id="WixWPF38_VS$(var.VsVer)Extension">
      <Component Id="WixWPF38_VS$(var.VsVer)ManifestComponent" Directory="WixWPF38_VS$(var.VsVer)ExtensionsDir" Guid="{22CDF595-EED9-4F36-98CA-A2FEDDBA0573}">
        <File Id="WixWPF38_VS$(var.VsVer)ManifestFile" KeyPath="yes" Source="$(var.Ext38)\extension.vsixmanifest" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)LogoComponent" Directory="WixWPF38_VS$(var.VsVer)ExtensionsDir" Guid="{AC91F14B-657F-4C52-AC4B-1F2AAE7899F6}">
        <File Id="WixWPF38_VS$(var.VsVer)LogoFile" KeyPath="yes" Source="$(var.Ext38)\Logo.png" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperComponent" Directory="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperDir" Guid="{0972A9C4-CC4F-4DF9-9225-825E7E7D991F}">
        <File Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperFile" KeyPath="yes" Source="$(var.Ext38)\WPFBootstrapper\WPFBootstrapper.zip" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperSolutionComponent" Directory="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperSolutionDir" Guid="{E5B3C013-DB45-4C63-875D-228BB6B03FB4}">
        <File Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperSolutionFile" KeyPath="yes" Source="$(var.Ext38)\WPFBootstrapperSolution\WPFBootstrapperSolution.zip" />
      </Component>
      <Component Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperUIComponent" Directory="WixWPF38_VS$(var.VsVer)TemplatesWPFBootstrapperUIDir" Guid="{A26794BA-6CA6-45B4-AF8A-35D1616956D5}">
        <File Id="WixWPF38_VS$(var.VsVer)WPFBootstrapperUIFile" KeyPath="yes" Source="$(var.Ext38)\WPFBootstrapperUI\WPFBootstrapperUI.zip" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>